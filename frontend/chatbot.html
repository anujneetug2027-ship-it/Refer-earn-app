<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ask AmbikaShelf</title>

<style>
body{
  margin:0;
  font-family:Inter,system-ui;
  background:linear-gradient(180deg,#071124 0%, #071a2b 100%);
  color:#fff;
  display:flex;
  flex-direction:column;
  height:100vh;
}

.chat-box{
  flex:1;
  overflow-y:auto;
  padding:15px;
}

.msg{
  max-width:75%;
  padding:10px 14px;
  border-radius:16px;
  margin-bottom:10px;
}

.user{
  background:#06b6d4;
  color:black;
  align-self:flex-end;
}

.bot{
  background:rgba(255,255,255,0.1);
}

.input-area{
  display:flex;
  padding:10px;
  background:#0b1220;
  gap:8px;
}

input{
  flex:1;
  padding:10px;
  border-radius:10px;
  border:none;
}
button{
  background:#06b6d4;
  border:none;
  padding:10px;
  border-radius:10px;
}
img{
  max-width:200px;
  border-radius:10px;
}
</style>
</head>
<body>

<div class="chat-box" id="chat"></div>

<div class="input-area">
  <input type="file" id="imageInput">
  <input id="prompt" placeholder="Ask something...">
  <button onclick="sendBot()">Send</button>
</div>

<script>
const API_KEY="AIzaSyC0jzGXPrrmV6dUNenxayX3p_2NniUIJOo";

async function sendBot(){
  const prompt=document.getElementById("prompt").value;
  const file=document.getElementById("imageInput").files[0];
  const chat=document.getElementById("chat");

  if(!prompt && !file) return;

  const userDiv=document.createElement("div");
  userDiv.className="msg user";
  userDiv.innerText=prompt || "Image Sent";
  chat.appendChild(userDiv);

  chat.scrollTop=chat.scrollHeight;

  let parts=[{text:prompt||"Describe this image"}];

  if(file){
    const base64=await toBase64(file);
    parts.push({
      inlineData:{
        mimeType:file.type,
        data:base64.split(",")[1]
      }
    });
  }

  const res=await fetch(
    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${API_KEY}`,
    {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({contents:[{parts}]})
    }
  );

  const data=await res.json();

  const botText=data.candidates?.[0]?.content?.parts?.[0]?.text || "Error";

  const botDiv=document.createElement("div");
  botDiv.className="msg bot";
  botDiv.innerText=botText;
  chat.appendChild(botDiv);

  chat.scrollTop=chat.scrollHeight;
}

function toBase64(file){
  return new Promise(resolve=>{
    const reader=new FileReader();
    reader.onload=()=>resolve(reader.result);
    reader.readAsDataURL(file);
  });
}
</script>

</body>
</html>
