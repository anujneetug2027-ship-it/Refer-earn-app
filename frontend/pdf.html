<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AmbikaShelf Professional Image to PDF Editor</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>

<style>

/* ===========================
   GLOBAL STYLES
=========================== */

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
}

body{
  font-family:Segoe UI, sans-serif;
  background:linear-gradient(135deg,#0f172a,#111827);
  color:white;
  min-height:100vh;
}

header{
  background:#111827;
  padding:20px;
  text-align:center;
  box-shadow:0 5px 20px rgba(0,0,0,0.4);
}

header img{
  height:65px;
}

.container{
  max-width:1200px;
  margin:auto;
  padding:25px;
}

h2{
  text-align:center;
  font-weight:500;
  margin-bottom:25px;
}
/* ------------------&&&&&------*/
   .editor-ui{
  width:95vw;
  max-width:1000px;
}

.toolbar{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  justify-content:center;
  margin-bottom:10px;
}

.toolbar button{
  background:#1f2937;
  color:white;
  border:none;
  padding:8px 12px;
  border-radius:6px;
  cursor:pointer;
}

.toolbar button:hover{
  background:#374151;
}

.divider{
  width:2px;
  background:#444;
  margin:0 5px;
}

.canvas-wrapper{
  position:relative;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
}

#editCanvas{
  max-width:100%;
  max-height:70vh;
  touch-action:none;
  background:#fff;
}

.bottom-actions{
  margin-top:10px;
  text-align:center;
}

.bottom-actions button{
  margin:0 10px;
  padding:8px 16px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
/* ===========================
   LIVE PREVIEW AREA
=========================== */

.preview-wrapper{
  display:none;
  height:620px;
  overflow-y:auto;
  border-radius:15px;
  background:#1e293b;
  padding:20px;
  margin-bottom:25px;
  box-shadow:0 10px 30px rgba(0,0,0,0.5);
}

.preview-page{
  background:white;
  width:100%;
  max-width:450px;
  height:630px;
  margin:0 auto 20px auto;
  border-radius:10px;
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
}

.preview-page img{
  width:100%;
  height:100%;
  object-fit:contain;
}

/* ===========================
   THUMBNAILS
=========================== */

.thumbnail-container{
  display:flex;
  gap:12px;
  overflow-x:auto;
  padding-bottom:10px;
}

.thumb{
  position:relative;
  cursor:grab;
}

.thumb img{
  width:115px;
  height:115px;
  object-fit:cover;
  border-radius:10px;
  border:2px solid #38bdf8;
}

.thumb-number{
  position:absolute;
  top:5px;
  left:6px;
  background:black;
  padding:3px 7px;
  font-size:12px;
  border-radius:6px;
}

.thumb button{
  position:absolute;
  width:23px;
  height:23px;
  border:none;
  border-radius:50%;
  font-size:13px;
  cursor:pointer;
}

.remove-btn{
  top:5px;
  right:5px;
  background:red;
  color:white;
}

.edit-btn{
  bottom:5px;
  right:5px;
  background:#38bdf8;
  color:black;
}

.add-thumb{
  width:115px;
  height:115px;
  border-radius:10px;
  border:2px dashed #38bdf8;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:32px;
  cursor:pointer;
}

/* ===========================
   CONTROLS
=========================== */

.controls{
  text-align:center;
  margin-top:25px;
}

.controls input{
  padding:10px;
  border-radius:8px;
  border:none;
  margin:8px;
  min-width:220px;
}

.controls button{
  padding:10px 20px;
  border:none;
  border-radius:8px;
  background:#38bdf8;
  font-weight:600;
  cursor:pointer;
  margin:10px;
}

/* ===========================
   EDIT MODAL
=========================== */

.modal{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.85);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
}

.modal-content{
  background:#111827;
  padding:20px;
  border-radius:12px;
  text-align:center;
}
#editCanvas{
  background:white;
  border-radius:8px;
  cursor:crosshair;
  max-width:800px;
  max-height:70vh;
   }

.modal-buttons button{
  padding:8px 15px;
  margin:8px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
/* SITE FOOTER */
.site-footer{background:#0a0f1a;border-top:1px solid rgba(255,255,255,0.04);padding:40px 20px 20px;margin-top:40px;color:#94a3b8;font-size:14px;}
.footer-inner{max-width:1000px;margin:auto;display:grid;grid-template-columns:repeat(4,1fr);gap:30px;}
.footer-inner h4{color:#06b6d4;margin:0 0 12px;font-size:15px;}
.footer-inner a{display:block;color:#94a3b8;text-decoration:none;padding:4px 0;transition:color .2s;}
.footer-inner a:hover{color:#e6eef8;}
.footer-bottom{max-width:1000px;margin:24px auto 0;text-align:center;border-top:1px solid rgba(255,255,255,0.04);padding-top:18px;font-size:13px;color:#64748b;}
.footer-bottom .tagline{margin-bottom:6px;font-size:14px;color:#94a3b8;}
@media(max-width:600px){.footer-inner{grid-template-columns:1fr 1fr;gap:20px;}}

</style>
</head>
<body>

<header>
  <img src="https://ambikashelf.shop/ambikashelf.png">
</header>

<div class="container">

<h2>Professional Image to PDF Editor</h2>

<div id="previewWrapper" class="preview-wrapper"></div>

<div id="thumbnailContainer" class="thumbnail-container"></div>

<div class="controls">

<input type="file" id="fileInput" accept="image/*" multiple>
<br>
<input type="text" id="pdfName" placeholder="Enter PDF File Name">
<br>
<input type="password" id="pdfPassword" placeholder="Optional PDF Password">
<br>
<button onclick="downloadPDF()">Download PDF</button>

</div>

</div>

<footer class="site-footer">
  <div class="footer-inner">
    <div>
      <h4>Main</h4>
      <a href="index.html">Home</a>
      <a href="contact.html">Contact</a>
      <a href="about.html">About Us</a>
    </div>
    <div>
      <h4>Tools</h4>
      <a href="worldchat.html">WorldChat</a>
      <a href="qr.html">QR Scanner</a>
      <a href="pdf.html">PDF Maker</a>
    </div>
    <div>
      <h4>Legal</h4>
      <a href="terms.html">Terms &amp; Conditions</a>
      <a href="privacy.html">Privacy Policy</a>
    </div>
    <div>
      <h4>Social</h4>
      <a href="#">GitHub</a>
      <a href="#">YouTube</a>
      <a href="#">Instagram</a>
      <a href="#">Facebook</a>
    </div>
  </div>
  <div class="footer-bottom">
    <div class="tagline">Made with ‚ù§Ô∏è &amp; ü§ñ in India</div>
    <div>¬© AmbikaShelf 2026 ‚Äî All rights reserved.!</div>
  </div>
</footer>

<!-- EDIT MODAL -->

<div class="modal" id="editModal">
  <div class="modal-content editor-ui">

    <div class="toolbar">
      <button onclick="setTool('crop')">Crop</button>
      <button onclick="setTool('draw')">Pen</button>
      <button onclick="setTool('text')">Text</button>
      <button onclick="undo()">Undo</button>

      <div class="divider"></div>

      <button onclick="setColor('#000000')">Black</button>
      <button onclick="setColor('#ff0000')">Red</button>
      <button onclick="setColor('#0066ff')">Blue</button>
      <button onclick="setColor('rgba(255,255,0,0.4)')">Highlight</button>

      <div class="divider"></div>

      <button onclick="setSize(2)">Thin</button>
      <button onclick="setSize(6)">Medium</button>
      <button onclick="setSize(12)">Thick</button>
    </div>

    <div class="canvas-wrapper">
      <canvas id="editCanvas"></canvas>
    </div>

    <div class="bottom-actions">
      <button onclick="applyEdit()">Apply</button>
      <button onclick="closeModal()">Cancel</button>
    </div>

  </div>
</div>
<script>

/* =============================
   GLOBAL STATE
============================= */

const fileInput = document.getElementById("fileInput");
const thumbnailContainer = document.getElementById("thumbnailContainer");
const previewWrapper = document.getElementById("previewWrapper");
const pdfNameInput = document.getElementById("pdfName");
const pdfPasswordInput = document.getElementById("pdfPassword");

const editModal = document.getElementById("editModal");
const editCanvas = document.getElementById("editCanvas");
const editCtx = editCanvas.getContext("2d");

let images = [];
let currentEditIndex = null;


/* =============================
   FILE UPLOAD
============================= */

fileInput.addEventListener("change", e=>{
  const files = e.target.files;

  for(let file of files){
    if(images.length >= 10){
      alert("Maximum 10 images allowed.");
      return;
    }

    const reader = new FileReader();
    reader.onload = ev=>{
      images.push(ev.target.result);
      renderThumbnails();
      renderPreview();
    };
    reader.readAsDataURL(file);
  }
});

/* =============================
   THUMBNAILS
============================= */

function renderThumbnails(){
  thumbnailContainer.innerHTML = "";

  images.forEach((src,index)=>{

    const div = document.createElement("div");
    div.className = "thumb";
    div.dataset.index = index;

    const img = document.createElement("img");
    img.src = src;

    const number = document.createElement("div");
    number.className = "thumb-number";
    number.textContent = index + 1;

    const removeBtn = document.createElement("button");
    removeBtn.className = "remove-btn";
    removeBtn.textContent = "√ó";

    removeBtn.addEventListener("click", function(e){
      e.stopPropagation();
      removeImage(index);
    });

    const editBtn = document.createElement("button");
    editBtn.className = "edit-btn";
    editBtn.textContent = "‚úè";

    editBtn.addEventListener("click", function(e){
      e.stopPropagation();
      openEditor(index);
    });

    div.appendChild(img);
    div.appendChild(number);
    div.appendChild(removeBtn);
    div.appendChild(editBtn);

    thumbnailContainer.appendChild(div);
  });

  const add = document.createElement("div");
  add.className="add-thumb";
  add.textContent="+";
  add.addEventListener("click", ()=>fileInput.click());

  thumbnailContainer.appendChild(add);
   }
function removeImage(index){
  images.splice(index,1);
  renderThumbnails();
  renderPreview();
}

/* =============================
   DRAG SORT
============================= */
new Sortable(thumbnailContainer,{
  animation:150,
  draggable: ".thumb",
  filter: "button",
  preventOnFilter: false,
  onEnd:function(evt){
    if(evt.oldIndex == null || evt.newIndex == null) return;

    const moved = images.splice(evt.oldIndex,1)[0];
    images.splice(evt.newIndex,0,moved);
    renderThumbnails();
    renderPreview();
  }
});

/* =============================
   LIVE PREVIEW
============================= */

function renderPreview(){
  previewWrapper.innerHTML="";

  if(images.length === 0){
    previewWrapper.style.display="none";
    return;
  }

  previewWrapper.style.display="block";

  images.forEach(src=>{
    const page = document.createElement("div");
    page.className="preview-page";

    const img = document.createElement("img");
    img.src = src;

    page.appendChild(img);
    previewWrapper.appendChild(page);
  });
}

/* =============================
   DOWNLOAD PDF
============================= */

async function downloadPDF(){
  if(images.length === 0) return alert("Add images first");

  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF("p","mm","a4");

  for(let i=0;i<images.length;i++){
    const img = new Image();
    img.src = images[i];

    await new Promise(resolve=>{
      img.onload = function(){
        const w = pdf.internal.pageSize.getWidth();
        const h = pdf.internal.pageSize.getHeight();
        pdf.addImage(img,"JPEG",0,0,w,h);
        if(i < images.length-1) pdf.addPage();
        resolve();
      }
    });
  }

  const password = pdfPasswordInput.value.trim();
  if(password){
    try{
      pdf.setEncryption({
        userPassword: password,
        ownerPassword: password,
        userPermissions: ["print"]
      });
    }catch(e){
      console.warn("Encryption may not be supported in this browser.");
    }
  }

  let fileName = pdfNameInput.value.trim();
  if(!fileName) fileName = "AmbikaShelf";
  pdf.save(fileName + ".pdf");
}

/* =============================
   EDITOR
============================= */
/* =============================
   PROFESSIONAL EDITOR ENGINE
============================= */

let tool = null;
let baseImage = new Image();
let history = [];
let penColor = "#000000";
let penSize = 3;
let isDrawing = false;
let cropArea = null;
let dragging = false;

function openEditor(index){
  currentEditIndex = index;
  editModal.style.display = "flex";

  baseImage = new Image();
  baseImage.src = images[index];

  baseImage.onload = () => {
    editCanvas.width = baseImage.width;
    editCanvas.height = baseImage.height;
    redraw();
    history = [];
  }
}

function redraw(){
  editCtx.clearRect(0,0,editCanvas.width,editCanvas.height);
  editCtx.drawImage(baseImage,0,0);

  if(cropArea){
    editCtx.fillStyle="rgba(0,0,0,0.5)";
    editCtx.fillRect(0,0,editCanvas.width,editCanvas.height);
    editCtx.clearRect(cropArea.x,cropArea.y,cropArea.w,cropArea.h);
    editCtx.strokeStyle="#00ff00";
    editCtx.lineWidth=2;
    editCtx.strokeRect(cropArea.x,cropArea.y,cropArea.w,cropArea.h);
  }
}

function setTool(t){ tool = t; }
function setColor(c){ penColor = c; }
function setSize(s){ penSize = s; }

function getPos(e){
  const rect = editCanvas.getBoundingClientRect();
  const scaleX = editCanvas.width / rect.width;
  const scaleY = editCanvas.height / rect.height;

  let x,y;

  if(e.touches){
    x = e.touches[0].clientX;
    y = e.touches[0].clientY;
  } else {
    x = e.clientX;
    y = e.clientY;
  }

  return {
    x:(x - rect.left)*scaleX,
    y:(y - rect.top)*scaleY
  };
}

editCanvas.addEventListener("mousedown",startAction);
editCanvas.addEventListener("mousemove",moveAction);
editCanvas.addEventListener("mouseup",endAction);

editCanvas.addEventListener("touchstart",e=>{e.preventDefault();startAction(e)});
editCanvas.addEventListener("touchmove",e=>{e.preventDefault();moveAction(e)});
editCanvas.addEventListener("touchend",endAction);

function startAction(e){
  const pos = getPos(e);
  isDrawing = true;

  if(tool==="draw"){
    editCtx.beginPath();
    editCtx.moveTo(pos.x,pos.y);
  }

  if(tool==="crop"){
    cropArea = {x:pos.x,y:pos.y,w:0,h:0};
  }

  if(tool==="text"){
    const txt = prompt("Enter text");
    if(txt){
      editCtx.fillStyle=penColor;
      editCtx.font=`${penSize*8}px Arial`;
      editCtx.fillText(txt,pos.x,pos.y);
      saveHistory();
    }
  }
}

function moveAction(e){
  if(!isDrawing) return;
  const pos = getPos(e);

  if(tool==="draw"){
    editCtx.strokeStyle=penColor;
    editCtx.lineWidth=penSize;
    editCtx.lineTo(pos.x,pos.y);
    editCtx.stroke();
  }

  if(tool==="crop"){
    cropArea.w = pos.x - cropArea.x;
    cropArea.h = pos.y - cropArea.y;
    redraw();
  }
}

function endAction(){
  isDrawing=false;
  if(tool==="draw") saveHistory();
}

function applyEdit(){
  if(tool==="crop" && cropArea){
    const temp=document.createElement("canvas");
    temp.width=Math.abs(cropArea.w);
    temp.height=Math.abs(cropArea.h);
    const t=temp.getContext("2d");

    t.drawImage(
      baseImage,
      cropArea.x,
      cropArea.y,
      cropArea.w,
      cropArea.h,
      0,
      0,
      cropArea.w,
      cropArea.h
    );

    images[currentEditIndex]=temp.toDataURL("image/jpeg");
  } else {
    images[currentEditIndex]=editCanvas.toDataURL("image/jpeg");
  }

  closeModal();
  renderPreview();
  renderThumbnails();
}

function saveHistory(){
  history.push(editCanvas.toDataURL());
}

function undo(){
  if(history.length>0){
    const img=new Image();
    img.src=history.pop();
    img.onload=()=>editCtx.drawImage(img,0,0);
  }
}

function closeModal(){
  editModal.style.display="none";
  cropArea=null;
  tool=null;
   }
        </script>

</body>
</html>
